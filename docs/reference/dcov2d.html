<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast dCor and dCov for bivariate data only — dcov2d • energy</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fast dCor and dCov for bivariate data only — dcov2d" />

<meta property="og:description" content="For bivariate data only, these are fast O(n log n) implementations of distance
correlation and distance covariance statistics. The U-statistic for dcov^2 is unbiased; 
the V-statistic is the original definition in SRB 2007. These algorithms do not
store the distance matrices, so they are suitable for large samples." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">energy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mariarizzo/energy">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast dCor and dCov for bivariate data only</h1>
    
    <div class="hidden name"><code>dcov2d.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>For bivariate data only, these are fast O(n log n) implementations of distance
correlation and distance covariance statistics. The U-statistic for dcov^2 is unbiased; 
the V-statistic is the original definition in SRB 2007. These algorithms do not
store the distance matrices, so they are suitable for large samples.</p>
    
    </div>

    <pre class="usage"><span class='fu'>dcor2d</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"V"</span>, <span class='st'>"U"</span>))
<span class='fu'>dcov2d</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"V"</span>, <span class='st'>"U"</span>), <span class='kw'>all.stats</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>dcov2d.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>250</span>)
<span class='fu'>dcor2d.test</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>250</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric vector</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric vector</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>"V" or "U", for V- or U-statistics</p></td>
    </tr>
    <tr>
      <th>all.stats</th>
      <td><p>logical</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>number of eigenvalues</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The unbiased (squared) dcov is documented in <code>dcovU</code>, for multivariate data in arbitrary, not necessarily equal dimensions. <code>dcov2d</code> and <code>dcor2d</code> provide a faster O(n log n) algorithm for bivariate (x, y) only (X and Y are real-valued random vectors). The O(n log n) algorithm was proposed by Huo and Szekely (2016). The algorithm is faster above a certain sample size n. It does not store the distance matrix so the sample size can be very large. An O(n log n) test based on the asymptotic distribution of \(n V_n\) is provided by <code>dcov2d.test</code> and <code>dcor2d.test</code>.</p>
<p>For details about inference with distance covariance see <code>dcov</code>, 
<code>dcor</code>, <code>dcov.test</code> and <code>dcor.test</code>.</p>
<p>The argument <code>m</code> specifies the number of eigenvalues estimated for computing the asymptotic null distribution of the test statistic. Use the permutation test <code>dcov.test</code> (or <code>dcor.test</code>) if n &lt; 200. Typically m = 250 is large enough for accurate upper tail probabilities.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>By default, <code>dcov2d</code> returns the V-statistic \(V_n = dCov_n^2(x, y)\), and if type="U", it returns the U-statistic, unbiased for \(dCov^2(X, Y)\). The argument all.stats=TRUE is used internally when the function is called from <code>dcor2d</code>.</p>
<p>By default, <code>dcor2d</code> returns \(dCor_n^2(x, y)\), and if type="U", it returns a bias-corrected estimator of squared dcor equivalent to <code>bcdcor</code>.</p>
<p><code>dcov2d.test</code> and <code>dcor2d.test</code> return a list with class <code>htest</code> containing</p>
<dt>     method</dt><dd><p>description of test</p></dd>
   <dt>  statistic</dt><dd><p>observed value of the test statistic</p></dd>
   <dt>   estimate</dt><dd><p>V_n, R_n (squared dcor)</p></dd>
   <dt>    p.value</dt><dd><p>approximate p-value of the test</p></dd>
   <dt>  data.name</dt><dd><p>description of data</p></dd>

These functions do not store the distance matrices so they are helpful when sample size is large and the data is bivariate. 

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The U-statistic \(U_n\) can be negative in the lower tail so 
the square root of the U-statistic is not applied.
Similarly, <code>dcor2d(x, y, "U")</code> is bias-corrected and can be
negative in the lower tail, so we do not take the
square root. The original definitions of dCov and dCor 
(SRB2007, SR2009) were based on V-statistics, which are non-negative,
and defined using the square root of V-statistics.</p>
<p>It has been suggested that instead of taking the square root of the U-statistic, one could take the root of \(|U_n|\) before applying the sign, but that introduces more bias than the original dCor, and should never be used.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='dcov.html'>dcov</a></code> <code><a href='dcov.test.html'>dcov.test</a></code>  <code><a href='dcov.html'>dcor</a></code> <code><a href='dcov.test.html'>dcor.test</a></code> (multivariate statistics and permutation test)</p></div>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Huo, X. and Szekely, G.J. (2016). Fast computing for 
distance covariance. Technometrics, 58(4), 435-447.</p>
<p>Szekely, G.J. and Rizzo, M.L. (2014),
 Partial Distance Correlation with Methods for Dissimilarities.
 <em>Annals of Statistics</em>, Vol. 42 No. 6, 2382-2412.</p>
<p>Szekely, G.J., Rizzo, M.L., and Bakirov, N.K. (2007),
 Measuring and Testing Dependence by Correlation of Distances,
 <em>Annals of Statistics</em>, Vol. 35 No. 6, pp. 2769-2794.
 <br /> <a href='http://dx.doi.org/10.1214/009053607000000505'>http://dx.doi.org/10.1214/009053607000000505</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  </div><div class='input'>    <span class='co'>## these are equivalent, but 2d is faster for n &gt; 50</span>
    <span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
    <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/all.equal'>all.equal</a></span>(<span class='fu'><a href='dcov.html'>dcov</a></span>(<span class='no'>x</span>, <span class='no'>y</span>)^<span class='fl'>2</span>, <span class='fu'>dcov2d</span>(<span class='no'>x</span>, <span class='no'>y</span>), <span class='kw'>check.attributes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/all.equal'>all.equal</a></span>(<span class='fu'><a href='dcovu.html'>bcdcor</a></span>(<span class='no'>x</span>, <span class='no'>y</span>), <span class='fu'>dcor2d</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='st'>"U"</span>), <span class='kw'>check.attributes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Lognormal'>rlnorm</a></span>(<span class='fl'>400</span>)
    <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Exponential'>rexp</a></span>(<span class='fl'>400</span>)
    <span class='fu'><a href='dcov.test.html'>dcov.test</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>199</span>)  <span class='co'>#permutation test</span></div><div class='output co'>#&gt; 
#&gt; 	dCov test of independence
#&gt; 
#&gt; data:  index 1, replicates 199
#&gt; nV^2 = 1.1615, p-value = 0.635
#&gt; sample estimates:
#&gt;       dCov 
#&gt; 0.05388702 
#&gt; </div><div class='input'>    <span class='fu'>dcov2d.test</span>(<span class='no'>x</span>, <span class='no'>y</span>)       <span class='co'>#large sample test</span></div><div class='output co'>#&gt; 
#&gt; 	dCov independence test
#&gt; 
#&gt; data:  Bivariate sample size  400
#&gt; n V_n = 1.1615, p-value = 0.5648
#&gt; sample estimates:
#&gt; V-statistic  R (dCor^2) 
#&gt; 0.002903811 0.005639541 
#&gt; </div><div class='input'>    <span class='fu'><a href='dcov.test.html'>dcor.test</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>199</span>)</div><div class='output co'>#&gt; 
#&gt; 	dCor test of independence
#&gt; 
#&gt; data:  index 1, replicates 199
#&gt; dCor = 0.075097, p-value = 0.61
#&gt; sample estimates:
#&gt; [1] 0.05388702 0.07509687 0.97307879 0.52914741
#&gt; </div><div class='input'>    <span class='fu'>dcor2d.test</span>(<span class='no'>x</span>, <span class='no'>y</span>)</div><div class='output co'>#&gt; 
#&gt; 	dCor independence test
#&gt; 
#&gt; data:  Bivariate sample size  400
#&gt; n V_n = 1.1615, p-value = 0.5509
#&gt; sample estimates:
#&gt; V-statistic  R (dCor^2) 
#&gt; 0.002903811 0.005639541 
#&gt; </div><div class='input'>    </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Maria L. Rizzo <a href='mailto:mrizzo @ bgsu.edu'>mrizzo @ bgsu.edu</a> and
Gabor J. Szekely</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Maria Rizzo, Gabor Szekely.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

